# 3. 线性神经网络

## 3.1 线性回归

1. 什么是回归？
2. 再问一次，梯度是什么，梯度方向为什么是函数增加最快的方向？

## 3.2 线性回归的从零开始实现

1. 整个过程分成哪些步骤？

   > 1. 生成、读取**数据集**
   > 2. 定义**模型、损失函数、优化算法**
   > 3. **训练**
   
2. 数据集如何生成？

3. 数据集如何读取？**迭代器**作用、意义是什么？迭代器怎么实现？

4. **模型**如何定义？输入是哪些？输出是什么？

5. **损失函数**如何定义？输入是什么？输出是什么？

6. **优化算法**如何定义？输入是什么？输出是什么？作用是什么？

7. **训练步骤**是怎样的？

   > 1. 设定 epoch 的次数，即：**模型要训练多少回**。
   > 2. 在**一次 epoch 里**：
   >    1. 从数据集迭代器中取 *数据*
   >    2. 计算模型 *输出值*
   >    3. 计算模型 *误差值*
   >    4. 计算模型误差的 *梯度*
   >    5. 运用优化算法 *更新模型参数*
   > 3. 计算一次**平均误差**。

   ```python
   # 核心代码
   # 1. 循环训练epoch次
   for epoch in range(num_epoches):
       # 2. 每一次取出 batch_size 个样本除了，做一次计算
       for X, y in data_iter(batch_size, features, labels):
           # 2.1 计算模型输出值，计算模型损失函数
           l = loss(net(X, w, b), y)
           # 2.2 反向传播，即计算各个参数的偏导数
           l.sum().backward()
           # 2.3 更新各个参数
           sgd([w, b], lr, batch_size)
       # 3. 计算平均误差
       with torch.no_grad():
           train_l = loss(net(features, w, b), labels)
           print(f'epoch {epoch + 1}, loss {float(train_l.mean()):f}')
   ```

   ## 3.2 线性回归的简洁实现

   1. 3.1节的过程如何使用 torch 包来简洁实现？

   2. 对应过程分别用什么包的什么类来实现？

      **分析**

      >1. 数据迭代器：  `torch.utils` 里面的 `data` 包。用到了 `TensorDataset` 类封装数据集，使用 `DataLoader` 类来封装迭代器。
      >
      > 2. 模型定义：  `torch` 里面的 `nn` 包。使用 `Sequential` 类来管理网络的每一层及其参数，`Linear` 类来定义线性模型。
      >
      >3. 误差函数：  `torch` 里面的 `nn` 包。用到了 `MSELoss` 类来实现均方误差。
      >
      > 4. 优化器： `torch` 里面的 `optim` 包。用到了 `SGD` 类来实现小批量随机梯度下降法。
      
      **总结**
      
      > 1. `torch.nn`：模型、模型管理器、误差函数。
      > 2. `torch.optim`：优化器。
      > 3. `torch.utils.data`：数据集管理器、数据加载器。

## 3.3 $softmax$ 回归

1. 回归解决哪两类问题？

2. 如何从之前的线性回归延申到 $softmax$ 回归？

3. $softmax$ 函数表达式时什么？

4. $softmax$ 函数是线性的？为啥$softmax$回归是线性模型？

5. 误差函数的推导思路一般是怎样的？

   > 1. 输入是什么？输出是什么？标签是什么？权重是什么？即：**先确定 $\mathbf{x_{i}}$、$\hat{y_{i}}$、$y_{i}$ 和 $\mathbf{W}$**
   > 2. 计算一个样本的误差
   > 3. 计算全部样本的平均误差

6. 概率是什么？信息量是什么？熵是什么？什么是相对熵？交叉熵是什么？

## 3.4 图像分类数据集

1. 手写字体 MNIST，比较老，现在使用 Fashion-MNIST
2. 
